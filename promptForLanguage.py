import datetime
import signal
import sys

import pandas as pd

from src.utils.api import callLlamaApi


PROMPTS = {
  'en': """
    You are a text detoxifier. On input you receive a text which may be toxic or harmful. Your task is to rewrite this text in a non harmful or toxic way while preserving the original content and context.
    Output only contains the detoxified text, nothing else like notes or additional information. You do not add any more context to the resulting text, which is not in the original text. Do not rewrite the original text too much, just either remove the toxic part completely, or replace it with some non-toxic words while preserving the meaning and context.
    Here are some examples what should be the output for given texts:
    - Input: "then all of a sudden i see her , shes now got the big phony tits and everything .", 
      Output: "All of a sudden i see her, she is all grown up.",
    - Input: "My page should be protected first so that worthless scum like you can't keep vandalizing it.",
      Output: "My page should be protected first so that unpleasant people like you can't keep vandalizing it.",
    - Input: "You made a mistake you ass.",
      Output: "You made a mistake.",
    - Input: "you know more than these idiots , stay the course and the truth will prevail .", 
      Output: "you know more than these people , stay the course and the truth will prevail .",
    - Input: "piss me off , fuckin jerk , get on my nerves .",
      Output: "get on my nerves",
    - Input: "In addition, I see no sock puppet, jackass.",
      Output: "In addition, I see no sock puppet.",

    Your output is only the detoxified text, you do not say anything else.
    Input: "{phrase}"
  """,
  'zh': """
    ไฝๆฏไธๅๆๆฌ่งฃๆฏๅใๅจ่พๅฅๆถ๏ผๆจไผๆถๅฐไธๆฎตๅฏ่ฝๆๆฏๆๆๅฎณ็ๆๅญใไฝ็ไปปๅกๆฏๅจไฟ็ๅๆๅๅฎนๅไธไธๆ็ๅๆไธ๏ผไปฅๆๅฎณๆๆๆฏ็ๆนๅผๆนๅ่ฟๆฎตๆๅญใ
    ่พๅบๅชๅๅซ่งฃๆฏๅ็ๆๆฌ๏ผไธๅๅซๆณจ้ๆๅถไปไฟกๆฏใๆจไธ่ฝๅจ็ๆ็ๆๆฌไธญๆทปๅๆดๅคๅๆไธญๆฒกๆ็ไธไธๆใไธ่ฆๅฏนๅๆ่ฟ่ก่ฟๅคๆนๅ๏ผๅช้ๅฐๆๆฏ้จๅๅฎๅจๅ้ค๏ผๆ็จไธไบๆๆฏ่ฏ่ฏญๆฟๆข๏ผๅๆถไฟ็ๅถๅซไนๅไธไธๆใ
    ไธ้ขๆฏไธไบ็ปๅฎๆๆฌ่พๅบ็ปๆ็็คบไพ๏ผ
    - ่พๅฅ๏ผ โๅฐฝ็ฎกๆตช๏ผ่ฐๆฅ็่ฐๆฏ็๏ผไธๅพhouseโใ 
      ่พๅบ๏ผ โๅฐฝ็ฎกๆตช๏ผ่ฐๆฅ็่ฐๆฏ็๏ผไธๅพๅฅฝไธๅบโใ
    - ่พๅฅ๏ผ โๅฏน้ปๅฝ็ๅคไปๆ่๏ผ่ฎฉๆฅๆฌ้ฅฎ้ธฉๆญขๆธด๏ผ็่ณ่ฎฉ้ปไปฃ่กจๆฅๆฌไบบ๏ผๆ็ดไบๆฅๆฌไฟๆๆฐๆ็บฏๆดๆง็ๆๅไธ็น่ชๅฐๆ็ดไบๅฐ่ฑกไธญๆฅๆฌๅฏนไบ้ปไธฅๆผ็ฎกๆง็็ฅ่ฏๆณกๆฒซๅฝๆน็ปๅบๆฏๆ้ปๅฝๆฅๅค็่ชๆ็ฎๅๅฟ็โใ
      ่พๅบ๏ผ โๅฏน้ปๅฝ็ๅคไปๆ่๏ผ่ฎฉๆฅๆฌ้ฅฎ้ธฉๆญขๆธด๏ผ็่ณ่ฎฉ้ปไบบไปฃ่กจๆฅๆฌไบบ๏ผๆ็ดไบๆฅๆฌไฟๆๆฐๆ็บฏๆดๆง็ๆๅไธ็น่ชๅฐๆ็ดไบๅฐ่ฑกไธญๆฅๆฌๅฏนไบ้ปไบบไธฅๆผ็ฎกๆง็็ฅ่ฏๆณกๆฒซๅฝๆน็ปๅบๆฏๆ้ปๅฝๆฅๅค็่ชๆ็ฎๅๅฟ็โใ
    - ่พๅฅ๏ผ โ้็นๆฏ่ง้ข้่ฟไธๆฏๅไธไธช้ปๅงโใ
      ่พๅบ๏ผ โ้็นๆฏ่ง้ข้่ฟไธๆฏๅไธไธช้ปไบบๅงโใ
    - ่พๅฅ๏ผ โ่ฟ็ง็ท็ๅฐฑๆดป่ฏฅ่ขซๆด็ปฟๅธฝโใ 
      ่พๅบ๏ผ โ่ฟ็ง็ท็่ขซ่ๅๆฏไธๅผๅพๅๆ็โใ
    - ่พๅฅ๏ผ โๅปบ่ฎฎไปๅฅณ็ปๅฉๅ๏ผ็ทๆงไธๅฎ่ฆๆๆ่ๅๆๅๅจฉๅๅๆๅญ็็่ฆ้ฝไฝ้ชไธ้๏ผ่ฟๅไธชๆไธๅฎ่ฆ็ฑๅฅนไปฌ็ง้กพ็ทๆง๏ผไปฅๆญคไฝไธบๅฅนไปฌ็่ฒๆถ่ขซ็ทๆงๅฏนๅพ็ๆๅใโใ
      ่พๅบ๏ผ โๅปบ่ฎฎ่ชๆๆ่ง่ฟไบ่ฏๅฅฝ็ๅฅณๆง็ปๅฉๅ๏ผ็ทๆงไธๅฎ่ฆๆๆ่ๅๆๅๅจฉๅๅๆๅญ็็่ฆ้ฝไฝ้ชไธ้๏ผ่ฟๅไธชๆไธๅฎ่ฆ็ฑๅฅนไปฌ็ง้กพ็ทๆง๏ผไปฅๆญคไฝไธบๅฅนไปฌ็่ฒๆถ่ขซ็ทๆงๅฏนๅพ็ๆๅใโใ
    - ่พๅฅ๏ผ โๅชๅๅผๆๆฎไฟก๏ผไธๅๅๆ่ชๅคงโโไบๆ็ฎกโใ
      ่พๅบ๏ผ โๅชๅๅผๆงๆๆฒกๆ่ช็ฅไนๆ๏ผไธๅๅๆงๆ่ชๅคงโโไบๆ็ฎกโใ

    ไฝ็่พๅบๅชๆฏ่งฃๆฏๅ็ๆๆฌ๏ผๆฒกๆๅถไปๅๅฎน
    ่พๅฅ๏ผโ{phrase}โ
  """,
  'am': """
    แฅแญแตแ แจแฝแแ แแญแแซ แแแตแข แแแคแต แแ แแญแแ แแญแ แแ แแแ แจแแฝแ แฝแแ แญแฐแญแตแแณแแข แแแแ แญแแต แฅแ แแแต แฅแจแแแ แญแแ แฝแแ แแ แฃแแแ แแญแ แแญแแ แแแ แแแแต แฅแแฐแแ แแแ แจแฅแญแตแ แฐแแฃแญ แแแข
    แแแแต แจแฐแแแฐแแ แฝแแ แฅแป แแ แจแแญแแแฃ แฅแแฐ แแตแณแแป แแญแ แฐแจแแช แแจแ แซแ แแ แแแ แแแญ แจแแแข แแแคแฑ แฝแแ แแญ แแแ แฐแจแแช แแแต แแตแจแแญแแฃ แญแแ แแแแแชแซแ แฝแแ แแตแฅ แจแแแข แแแแ แฝแแ แฅแ แแตแปแแฃ แแญแแแแ แญแแ แแ แแแ แแตแแแฑแฃ แแญแ แตแญแแแ แฅแ แแแฐ-แฝแแแ แฅแจแแแ แฃแ แแแณแแต แแญแแ แซแแแ แแแต แญแฐแฉแตแข
    แแฐแฐแกแต แฝแแแฝ แแแแต แแ แแแ แฅแแณแแแต แแแณแแต แแณแแแฝ แฅแแ แแแข
    - แแคแต: "แแแฑแฌ แตแแด แแ แแแฑแต แแ? แแแณแธแแ แจแแฌ แแญแ แแญแตแฐแแ แแแญ ??",
      แแคแต: "แฅแณแธแ แตแแด แแ แแฑ แฅแแ แจแแตแแแจแ ?",
    - แแคแตแก "แจแแ แแฃแตแ แแตแ แแ แจแแตแแญแจแ แแแฐ แแแตแต แฐแญแฃแ แจแแตแแ แแแฅ แแฃแแต แฅแซแตแจแแจแแญ แตแแแตแ แแจแแญ แจแแแ แแแฎ แแตแ_แตแแซแญ_แแตแข แต",
      แแคแต: "แแตแ แจแแแแญแจแ แแแฐ แจแแตแแ แแแฅ แฅแซแตแญแแ แแแ แจแแแตแ แจแแแ แแแฎ แแตแ แตแแซแญแ แจแขแตแฎแตแซแ แแตแข",
    - แแฅแแต: "แแแฅ แตแแญ แฃแฅแแฎ แแฅ แฅแ แแแญ แแ แฃแแฐ แจ7แแแแ แจแแแแญ แแ แฅแแแ แจแตแแซแญ แแแฅ แแแณ แฃแแฐ แฒแแ แจแฃแฅแ แปแญแ แแแญ แฅแฝแฃแแ แฅแแแฃแฅแแญ แญแตแแญ",
      แแคแตแก "แแตแแซแญ แแแฅ แแญ แฐแแข แซแแแ แแแฎแฝแ แจแแแธแ แฅแฐแแแฅ แจแฐแปแ แแแกแก",
    - แแฅแแตแก "แฃแแฐ แฐแแแช แแธแณแ แแแ แแแญ แแแแ แแ แฅแแณแแแแ แแธแณแ แจแแฒ",
      แแคแต: "แแแฐ แจแฐแซแแแ แแแ แแแญ แแแแ แแ แฅแแณแแแแ",
    - แแฅแแตแก โแฅแแ แแตแแแฅแ แแฝ แแแญแ แแแฃแฅ แแแฐแ แจแแฌ แแตแแซแช แจแแ แแช แญแแแโ,
      แแคแต: "แฅแแ แแฐแฐแต แณแซแฐแแแ แแฝ แแแญแ แแแฃแฅ แแแแฑ แจแฐแปแ แแแกแก แแ แแแฎแฝ แแแ แแญแแฅแ แญแฝแแแกแก",
    - แแฅแแต: "แฐแฐแฅ แแแ แแแฐ แแตแแตแ แแขแตแฎแฝแซ แแแตแแต แจแแ แแฝแแฃแญ แฐแแแ แแแแฐ แแตแฐแณแตแฅ แแ แแแต แแแแต แตแแแญ แซแต แแแแญแซ แฐแ แแ",
      แแคแต: "แจแขแตแฎแตแซแ แแแฐแแตแ แฐแ แณแญแแต แแแฃแต แแปแ แซแตแแแแแกแก",

    แจแฅแญแตแ แแแแต แจแฐแแแธ แฝแแ แฅแป แแ, แแ แแแ แแแญ แแญแแแฉแ.
    แแคแตแก "{phrase}"
  """,
  'ar': """
    ุฃูุช ูุฒูู ุงูุณููู ุงููุตูุฉ. ุนูุฏ ุงูุฅุฏุฎุงู ุชุชููู ูุตูุง ูุฏ ูููู ุณุงููุง ุฃู ุถุงุฑูุง. ูููุชู ูู ุฅุนุงุฏุฉ ูุชุงุจุฉ ูุฐุง ุงููุต ุจุทุฑููุฉ ุบูุฑ ุถุงุฑุฉ ุฃู ุณุงูุฉ ูุน ุงูุญูุงุธ ุนูู ุงููุญุชูู ูุงูุณูุงู ุงูุฃุตูู.
    ูุญุชูู ุงูุฅุฎุฑุงุฌ ุนูู ุงููุต ุงูุฐู ุชูุช ุฅุฒุงูุฉ ุงูุณููู ููู ููุทุ ููุง ุดูุก ุขุฎุฑ ูุซู ุงูููุงุญุธุงุช ุฃู ุงููุนูููุงุช ุงูุฅุถุงููุฉ. ูุง ุชุถูู ุฃู ุณูุงู ุขุฎุฑ ูููุต ุงููุงุชุฌ ุบูุฑ ููุฌูุฏ ูู ุงููุต ุงูุฃุตูู. ูุง ุชูู ุจุฅุนุงุฏุฉ ูุชุงุจุฉ ุงููุต ุงูุฃุตูู ุฃูุซุฑ ูู ุงููุงุฒูุ ููุท ูู ุจุฅุฒุงูุฉ ุงูุฌุฒุก ุงูุณุงู ุชูุงูุงูุ ุฃู ุงุณุชุจุฏูู ุจุจุนุถ ุงููููุงุช ุบูุฑ ุงูุณุงูุฉ ูุน ุงูุญูุงุธ ุนูู ุงููุนูู ูุงูุณูุงู.
    ูููุง ููู ุจุนุถ ุงูุฃูุซูุฉ ุนูู ูุง ูุฌุจ ุฃู ูููู ุงููุงุชุฌ ููุตูุต ูุนููุฉ:
    - ุงููุฏุฎูุงุช: โุซู ูุฌุฃุฉ ุฃุฑุงูุงุ ูุฏููุง ุงูุขู ุงูุซุฏู ุงููุจูุฑ ุงููุฒูู ููู ุดูุกโ, 
      ุงูุฅุฎุฑุงุฌ: โููุฌุฃุฉ ุฃุฑุงูุงุ ููุฏ ูุจุฑุช.โ,
    - ูุฏุฎูุงุช โูุฌุจ ุฃู ุชููู ุตูุญุชู ูุญููุฉ ุฃููุงู ุญุชู ูุง ูุชููู ุงูุญุซุงูุฉ ุนุฏููู ุงููููุฉ ุฃูุซุงูู ูู ุงูุงุณุชูุฑุงุฑ ูู ุชุฎุฑูุจูุง.โ
      ุงูุฅุฎุฑุงุฌ โูุฌุจ ุฃู ุชููู ุตูุญุชู ูุญููุฉ ุฃููุงู ุญุชู ูุง ูุณุชูุฑ ุงูุญุซุงูุฉ ุฃูุซุงูู ูู ุชุฎุฑูุจูุง.โ
    - ูุฏุฎูุงุช โููุฏ ุฃุฎุทุฃุช ุฃููุง ุงูุฃุญูู.โ,
      ุงูุฅุฎุฑุงุฌ โููุฏ ุงุฑุชูุจุช ุฎุทุฃ.โ
    - ุฅุฏุฎุงู: โุฃูุช ุชุนุฑู ุฃูุซุฑ ูู ูุคูุงุก ุงูุญูููุ ุงุจู ุนูู ุงููุณุงุฑ ูุงูุญูููุฉ ุณุชูุชุตุฑโ, 
      ุงูุฅุฎุฑุงุฌุ โุฃูุช ุชุนุฑู ุฃูุซุฑ ูู ูุคูุงุก ุงููุงุณุ ุงุจู ุนูู ุงููุณุงุฑ ูุงูุญูููุฉ ุณุชูุชุตุฑ .โ,
    - ูุฏุฎูุงุช โุฃุบุถุจูู ุฃููุง ุงูุฃุญูู ุงููุนููุ ุฃุบุถุจููโ,
      ุงูุฅุฎุฑุงุฌุ โุชุซูุฑ ุฃุนุตุงุจูโ,
    - ูุฏุฎูุงุช โุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ูุง ุฃุฑู ุฃู ุฏููุฉ ุฌูุฑุจ ุฃููุง ุงูุฃุญููโ,
      ุงูุฅุฎุฑุงุฌุ โุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ูุง ุฃุฑู ุฃู ุฏููุฉ ุฌูุฑุจ.โ,

    ูุฎุฑุฌุงุชู ูู ููุท ุงููุต ุงูููุฒูุน ุงูุณููู ููุทุ ูุง ุชููู ุฃู ุดูุก ุขุฎุฑ.
    ุงููุฏุฎูุงุช: โ{phrase}โ
  """,
  'de': """
    Sie sind ein Textentgifter. Bei der Eingabe erhalten Sie einen Text, der giftig oder schรคdlich sein kรถnnte. Ihre Aufgabe ist es, diesen Text so umzuschreiben, dass er nicht schรคdlich oder giftig ist, wobei der ursprรผngliche Inhalt und Kontext erhalten bleiben.
    Die Ausgabe enthรคlt nur den entgifteten Text, nichts anderes wie Anmerkungen oder zusรคtzliche Informationen. Sie fรผgen dem resultierenden Text keinen weiteren Kontext hinzu, der nicht im Originaltext enthalten ist. Schreiben Sie den Originaltext nicht zu sehr um, sondern entfernen Sie entweder den giftigen Teil vollstรคndig oder ersetzen Sie ihn durch einige ungiftige Wรถrter, wobei die Bedeutung und der Kontext erhalten bleiben.
    Hier sind einige Beispiele dafรผr, wie die Ausgabe fรผr gegebene Texte aussehen sollte:
    - Eingabe: "#LandderVollidioten #geisteskrank - "Kampf gg #Trump" (gg #Putin sowieso) Deutsches #Regime im Grรถรenwahn ....โ, 
      Output: "Kampf gg #Trump" (gg #Putin sowieso) Deutsches #Regime im Grรถรenwahn ....โ,
    - Input: "#Lindner steckt heute Abend schon seinen Kopf in den Arsch von #Merkel widerlich #FDPโ,
      Output: "#Lindner schmeichelt sich heute Abend schon wieder bei #Merkel ein #FDPโ,
    - Input: "Ob von Merkel oder Schulz? Wir Deutsche wollen und kรถnnen dieses Dummgelaber der Pest (Merkel) und Cholera (Schulz) nicht mehr hรถren!โ,
      Output: "Ob von Merkel oder Schulz? Wir Deutsche wollen und kรถnnen dieses Gerede von Merkel und Schulz nicht mehr hรถren!โ,
    - Input: "So ein schรคbiger Lump, lรคsst Kinder im Krieg allein und Fahnenfluchtโ, 
      Output: "So eine Person, lรคsst Kinder im Krieg allein und Fahnenfluchtโ,
    - Eingabe: "ich glaube nicht, das die Mehrheit der Bevรถlkerung dumm ist oder kommen nur Dumme zu Ihren Auftritten ?โ,
      Output: "ich glaube nicht, das die Mehrheit der Bevรถlkerung naiv ist oder kommen nur Naive zu Ihren Auftritten ?โ,
    - Input: "Wer will ein Hering So Dumm wie die Gรถring๐คฏโ,
      Output: "Wer will ein Hering So schlau wie die Gรถring๐คฏโ,

    Ihre Ausgabe ist nur der entgiftete Text, Sie sagen sonst nichts.
    Eingabe: "{phrase}โ
  """,
  'es': """
    Eres un desintoxicador de textos. Recibes un texto que puede ser tรณxico o daรฑino. Tu tarea consiste en reescribir este texto de forma que no sea tรณxico ni daรฑino, conservando el contenido y el contexto originales.
    La salida sรณlo contiene el texto desintoxicado, nada mรกs, como notas o informaciรณn adicional. No aรฑada mรกs contexto al texto resultante, que no estรฉ en el texto original. No reescriba demasiado el texto original, sรณlo elimine por completo la parte tรณxica o sustitรบyala por algunas palabras no tรณxicas conservando el significado y el contexto.
    He aquรญ algunos ejemplos de lo que deberรญa ser la salida para textos dados:
    - Entrada: ยซpues hazme los deberes furcia barataยป, 
      Salida: ยซBueno, haz mi tarea.ยป,
    - Entrada: ยซMarhuenda, ese gilipollas que dice que es catalรกn solo cuando pretende daรฑar a todos los catalanes, llama...ยป,
      Salida: ยซMaruenda, este que dice ser Catalรกn solo cuando pretende hacer daรฑo a todos los catalanes, llama...ยป,
    - Entrada: ยซNo se puede tener peor gusto diseรฑando camisetas pa una peรฑa Que verguenza mariconยป,
      Salida: ยซNo se puede tener peor gusto diseรฑando camisetas pa una peรฑa Que vergรผenza.ยป,
    - Entrada: ยซE si non eres un periodista decente deberรญas cambiar de profesiรณn, subnormal.ยป, 
      Salida: ยซE si non eres un periodista decente deberรญas cambiar de profesiรณn.ยป,
    - Entrada: ยซel Partido Socialista de Andalucรญa son una banda de delincuentes y chorizosยป,
      Salida: ยซel Partido Socialista de Andalucรญa no son honradosยป,
    - Entrada: ยซLa รบnica soluciรณn es irse de este paรญs de mierda.ยป,
      Salida: ยซLa รบnica soluciรณn es irse de este paรญs.ยป,

    Tu salida es sรณlo el texto desintoxicado, no dices nada mรกs.
    Entrada: ยซ{phrase}ยป
  """,
  'hi': """
    เคเคช เคเค เคเฅเคเฅเคธเฅเค เคกเคฟเคเฅเคเฅเคธเคฟเคซเคพเคฏเคฐ เคนเฅเคเฅค เคเคจเคชเฅเค เคชเคฐ เคเคชเคเฅ เคเค เคเฅเคเฅเคธเฅเค เคชเฅเคฐเคพเคชเฅเคค เคนเฅเคคเคพ เคนเฅ เคเฅ เคตเคฟเคทเคพเคเฅเคค เคฏเคพ เคนเคพเคจเคฟเคเคพเคฐเค เคนเฅ เคธเคเคคเคพ เคนเฅเฅค เคเคชเคเคพ เคเคพเคฐเฅเคฏ เคฎเฅเคฒ เคธเคพเคฎเคเฅเคฐเฅ เคเคฐ เคธเคเคฆเคฐเฅเคญ เคเฅ เคธเคเคฐเคเฅเคทเคฟเคค เคเคฐเคคเฅ เคนเฅเค เคเคธ เคชเคพเค เคเฅ เคเฅเคฐ เคนเคพเคจเคฟเคเคพเคฐเค เคฏเคพ เคตเคฟเคทเคพเคเฅเคค เคคเคฐเฅเคเฅ เคธเฅ เคซเคฟเคฐ เคธเฅ เคฒเคฟเคเคจเคพ เคนเฅเฅค
     เคเคเคเคชเฅเค เคฎเฅเค เคเฅเคตเคฒ เคกเคฟเคเฅเคเฅเคธเคฟเคซเคพเคเคก เคเฅเคเฅเคธเฅเค เคนเฅเคคเคพ เคนเฅ, เคจเฅเคเฅเคธ เคฏเคพ เคเคคเคฟเคฐเคฟเคเฅเคค เคเคพเคจเคเคพเคฐเฅ เคเฅเคธเคพ เคเฅเค เคจเคนเฅเคเฅค เคเคช เคชเคฐเคฟเคฃเคพเคฎเฅ เคชเคพเค เคฎเฅเค เคเฅเค เคเคฐ เคธเคเคฆเคฐเฅเคญ เคจเคนเฅเค เคเฅเคกเคผเคคเฅ เคนเฅเค, เคเฅ เคฎเฅเคฒ เคชเคพเค เคฎเฅเค เคจเคนเฅเค เคนเฅเฅค เคฎเฅเคฒ เคชเคพเค เคเฅ เคฌเคนเฅเคค เคเคงเคฟเค เคฆเฅเคฌเคพเคฐเคพ เคจ เคฒเคฟเคเฅเค, เคฌเคธ เคฏเคพ เคคเฅ เคตเคฟเคทเคพเคเฅเคค เคญเคพเค เคเฅ เคชเฅเคฐเฅ เคคเคฐเคน เคธเฅ เคนเคเคพ เคฆเฅเค, เคฏเคพ เคเคฐเฅเคฅ เคเคฐ เคธเคเคฆเคฐเฅเคญ เคเฅ เคธเคเคฐเคเฅเคทเคฟเคค เคเคฐเคคเฅ เคนเฅเค เคเคธเฅ เคเฅเค เคเฅเคฐ-เคตเคฟเคทเฅเคฒเฅ เคถเคฌเฅเคฆเฅเค เคธเฅ เคฌเคฆเคฒ เคฆเฅเคเฅค
     เคฏเคนเคพเค เคเฅเค เคเคฆเคพเคนเคฐเคฃ เคฆเคฟเค เคเค เคนเฅเค เคเคฟ เคฆเคฟเค เคเค เคเฅเคเฅเคธเฅเค เคเคพ เคเคเคเคชเฅเค เคเฅเคฏเคพ เคนเฅเคจเคพ เคเคพเคนเคฟเค:
     - เคเคจเคชเฅเค: "เคฆเฅเคเคฟเค เคเค เคเฅ เคฐเคฟเคชเฅเคฐเฅเค เคเคฎเฅเคถ เคญเคกเคผเคตเคพ เคธเฅ"
       เคเคเคเคชเฅเค: "เคฆเฅเคเคฟเค เคเค เคเฅ เคฐเคฟเคชเฅเคฐเฅเค เคฌเฅเคเคพเคฐ เคเคฎเฅเคถ เคธเฅ",
     - เคเคจเคชเฅเค: "เคฏเคนเฅ เคเค เคเคเคฐเฅ เคฐเคพเคธเฅเคคเคพ เคนเฅ เคธเคเคคเคพ เคนเฅ เคฌเคพเคเฅ เคธเฅเคเคฐ เคเฅ เคเคฒเคพเคฆ เคเคฟเคธเฅ เคเฅ เคจเคนเฅเค เคนเฅเคเฅ |"
       เคเคเคเคชเฅเค: "เคฏเคนเฅ เคเค เคเคเคฐเฅ เคฐเคพเคธเฅเคคเคพ เคนเฅ เคธเคเคคเคพ เคนเฅ เคฌเคพเคเฅ เคฌเฅเคเคพเคฐ เคฒเฅเค เคเคฟเคธเฅ เคเฅ เคจเคนเฅเค เคนเฅเคเคเฅ |"
     - เคเคจเคชเฅเค: "เคญเฅเคเคธเคกเคผเฅ เคเฅ เคคเฅเคฐเฅ เคชเคฟเคเคตเคพเคกเคผเฅ เคฎเฅเค เคเคพเคเคเฅเคฐเฅเคธ เคเคพ เคชเคเคเคพ เคชเคกเคผเฅเคเคพ เคคเฅ เคธเคฎเค เคฎเฅ เคเคเคเคพ",
       เคเคเคเคชเฅเค: "เคเคฌ เคเคพเคเคเฅเคฐเฅเคธ เคเฅเคคเฅเคเฅ เคคเคญเฅ เคคเฅเคเฅ เคธเคฎเค เคฎเฅ เคเคเคเคพ",
     - เคเคจเคชเฅเค: "เคญเคกเฅเคตเคพ เคเคพเคเค เคเคฐเคฒเฅ เคเคฟเคคเคจเคพ เคฒเคพเคญ เคฒเคฟเคฏเคพ เคคเฅ"
       เคเคเคเคชเฅเค: "เคเคพเคเค เคเคฐเคฒเฅ เคเคฟเคคเคจเคพ เคฒเคพเคญ เคฒเคฟเคฏเคพ เคคเฅ"
     - เคเคจเคชเฅเค: "เคญเฅเคธเคกเคผเฅ เคเฅ เคเคเฅเคตเฅ เคฎเคพเคฆเคฐเคเฅเคฆ, เคเฅ เคธเค เคนเฅ เคตเคนเฅ เคคเฅ เคธเฅเคฆเคฐเฅเคถเคจ เคจเฅเคฏเฅเค เคฆเคฟเคเคพเคคเคพ เคนเฅเฅค",
       เคเคเคเคชเฅเค: "เคเฅ เคธเค เคนเฅ เคตเคนเฅ เคคเฅ เคธเฅเคฆเคฐเฅเคถเคจ เคจเฅเคฏเฅเค เคฆเคฟเคเคพเคคเคพ เคนเฅเฅค",
     - เคเคจเคชเฅเค: "เคเคพเคฏเคฆเฅ เคธเฅ เคเค เคฅเคพเคฒเคพ เคเฅ เคฌเฅเคเคฟเคเค เคเคพ เคฎเฅเคเคพ เคจเคนเฅ เคฎเคฟเคฒเคจเคพ เคเคพเคนเคฟเค เคตเคฐเคจเคพ เคฅเคพเคฒเคพ เคเคพเคเคก เคเฅเค เคฆเฅเคเคพ, เคเคเคกเคฟเคฏเคพ เคเฅ",
       เคเคเคเคชเฅเค: "เคเคพเคฏเคฆเฅ เคธเฅ เคเค เคฅเคพเคฒเคพ เคเฅ เคฌเฅเคเคฟเคเค เคเคพ เคฎเฅเคเคพ เคจเคนเฅ เคฎเคฟเคฒเคจเคพ เคเคพเคนเคฟเค เคตเคฐเคจเคพ เคฅเคพเคฒเคพ เคเคเคกเคฟเคฏเคพ เคเฅ เคนเคฐเคตเคพ เคฆเฅเคเคพ",

     เคเคชเคเคพ เคเคเคเคชเฅเค เคเฅเคตเคฒ เคกเคฟเคเฅเคเฅเคธเคฟเคซเคพเคเคก เคเฅเคเฅเคธเฅเค เคนเฅ, เคเคช เคเคฐ เคเฅเค เคจเคนเฅเค เคเคนเคคเฅ เคนเฅเคเฅค
     เคเคจเคชเฅเค: "{phrase}"
  """,
  'ru': """
    ะั - ะดะตัะพะบัะธะบะฐัะพั ัะตะบััะพะฒ. ะะฐ ะฒัะพะด ะฒั ะฟะพะปััะฐะตัะต ัะตะบัั, ะบะพัะพััะน ะผะพะถะตั ะฑััั ัะพะบัะธัะฝัะผ ะธะปะธ ะฒัะตะดะฝัะผ. ะะฐัะฐ ะทะฐะดะฐัะฐ - ะฟะตัะตะฟะธัะฐัั ััะพั ัะตะบัั ัะฐะบะธะผ ะพะฑัะฐะทะพะผ, ััะพะฑั ะพะฝ ะฝะต ะฑัะป ะฒัะตะดะฝัะผ ะธะปะธ ัะพะบัะธัะฝัะผ, ัะพััะฐะฝะธะฒ ะฟัะธ ััะพะผ ะพัะธะณะธะฝะฐะปัะฝะพะต ัะพะดะตัะถะฐะฝะธะต ะธ ะบะพะฝัะตะบัั.
    ะะฐ ะฒััะพะดะต ะฒั ะฟะพะปััะฐะตัะต ัะพะปัะบะพ ะดะตัะพะบัะธัะธัะธัะพะฒะฐะฝะฝัะน ัะตะบัั, ะฑะตะท ะบะฐะบะธั-ะปะธะฑะพ ะฟัะธะผะตัะฐะฝะธะน ะธะปะธ ะดะพะฟะพะปะฝะธัะตะปัะฝะพะน ะธะฝัะพัะผะฐัะธะธ. ะั ะฝะต ะดะพะฑะฐะฒะปัะตัะต ะฒ ะฟะพะปััะตะฝะฝัะน ัะตะบัั ะบะพะฝัะตะบัั, ะบะพัะพัะพะณะพ ะฝะตั ะฒ ะธััะพะดะฝะพะผ ัะตะบััะต. ะะต ะฟะตัะตะฟะธััะฒะฐะนัะต ะพัะธะณะธะฝะฐะปัะฝัะน ัะตะบัั ัะปะธัะบะพะผ ัะธะปัะฝะพ, ะฟัะพััะพ ะปะธะฑะพ ะฟะพะปะฝะพัััั ัะดะฐะปะธัะต ัะพะบัะธัะฝัั ัะฐััั, ะปะธะฑะพ ะทะฐะผะตะฝะธัะต ะตะต ะฝะตัะพะบัะธัะฝัะผะธ ัะปะพะฒะฐะผะธ, ัะพััะฐะฝะธะฒ ะฟัะธ ััะพะผ ัะผััะป ะธ ะบะพะฝัะตะบัั.
    ะะพั ะฝะตัะบะพะปัะบะพ ะฟัะธะผะตัะพะฒ ัะพะณะพ, ััะพ ะดะพะปะถะฝะพ ะฟะพะปััะธัััั ะฝะฐ ะฒััะพะดะต ะดะปั ะทะฐะดะฐะฝะฝัั ัะตะบััะพะฒ:
    - ะะฒะพะด: ยซััะปะธ ะฒั ะฑะปัะดะธ ะบะปัะฝัะธัะต ะบะปะฐััั ,ะฟัะพััะพ ะฟะพะผะฝะธัะต.ยป, 
      ะัะฒะพะด: ยซัะฒะฐัะธั ะฒัะฟัะฐัะธะฒะฐัั ะบะปะฐััั, ะฟัะพััะพ ะฟะพะผะฝะธัะต.ยป,
    - ะัะพะด: ยซglav.su, cont.ws ะะฐะบะธะต-ัะพ ะธะฝัะตัะตัะฝัะต ัะฐะนัั? ะขั ัะฐะผ ัะธะดะธัั? ะะพะนะดั ัะตะบะฝั, ัะฟะฐัะธะฑะพ ะทะฐ ะฟะพะดัะบะฐะทะบั, ะฟะธะดะพัะฐั.ยป,
      ะััะพะดะฝัะต ะดะฐะฝะฝัะต: ยซะะฐะบะธะต-ัะพ ะธะฝัะตัะตัะฝัะต ัะฐะนัั? ะขั ัะฐะผ ัะธะดะธัั? ะะพะนะดั ัะพะถะต ััะพะถั, ัะฟะฐัะธะฑะพ ะทะฐ ะฟะพะดัะบะฐะทะบั.ยป,
    - ะัะพะด: ยซะตะฑะฐะฝัะน ะฒ ัะพั ะบะพะณะดะฐ ััะพ ะฟัะตะบัะฐัะธัััั ััะพ ะฝะฐะผ ะดะตะปะฐัั ะฒั ััะธััะฒะฐัั ะฟัััั ะทะฝะฐัะธั ัะฒะตั ะดะพัะพะถะฐะตั ะฐ ะตะณะพ ะฝะต ะฑัะฒะฐะตั .ยป,
      ะััะพะดะฝัะต ะดะฐะฝะฝัะต: ยซะบะพะณะดะฐ ััะพ ะฟัะตะบัะฐัะธัััั ััะพ ะฝะฐะผ ะดะตะปะฐัั ะฒั ััะธััะฒะฐัั ะฟัััั ะทะฝะฐัะธั ัะฒะตั ะดะพัะพะถะฐะตั ะฐ ะตะณะพ ะฝะต ะฑัะฒะฐะตั .ยป,
    - ะะฒะพะด: ยซัั ัั ะถะธะฒะตัั ะธ ะณััะทัั ัะพััะธั ะฟะพะปะตะฒะฐะตั.ััะนะปะพยป, 
      ะััะพะด: ยซัั ัั ะถะธะฒะตัั ะธ ะณััะทัั ัะพััะธั ะฟะพะปะตะฒะฐะตั.ยป,
    - ะัะพะด: ยซััะฐ ะฟะพัะพะดั ััะฐัะพะต ัะพัะพ,ะฒ ัะตัะตะดะธะฝะต ัััะบ ัะตะปะตะฟัะทะธะบ ะผัั ะพััะธ ะปะธัะพะฒัะบะธะน.ัะตะดะบะฐั ัะบะพัะธะฝะฐ.ยป,
      ะััะพะด: ยซะญัะพ ััะฐัะพะต ัะพัะพ, ะฒ ัะตัะตะดะธะฝะต ะผัั ะพััะธ ะปะธัะพะฒัะบะธะน.ยป,
    - ะะฒะพะด: ยซะดะฐ ะฒัะตะผ ะฝะฐััะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐะฐัั ะฝะฐ ััะพ ัะตะฑะธัะตยป,
      ะััะพะด: ยซะะฐ ะฒัะตะผ ะฒัั ัะฐะฒะฝะพ ะฝะฐ ััะพะณะพ ัะตะปะพะฒะตะบะฐยป,

    ะะฐั ะฒัะฒะพะด - ััะพ ัะพะปัะบะพ ะดะตัะพะบัะธัะธัะธัะพะฒะฐะฝะฝัะน ัะตะบัั, ะฑะพะปััะต ะฒั ะฝะธัะตะณะพ ะฝะต ะณะพะฒะพัะธัะต.
    ะะฒะพะด: ยซ{phrase}ยป
  """,
  'uk': """
    ะะธ - ัะตะบััะพะฒะธะน ะดะตัะพะบัะธะบะฐัะพั. ะะฐ ะฒััะด ะฒะธ ะพััะธะผัััะต ัะตะบัั, ัะบะธะน ะผะพะถะต ะฑััะธ ัะพะบัะธัะฝะธะผ ะฐะฑะพ ัะบัะดะปะธะฒะธะผ. ะะฐัะต ะทะฐะฒะดะฐะฝะฝั - ะฟะตัะตะฟะธัะฐัะธ ัะตะน ัะตะบัั ั ะฝะตัะบัะดะปะธะฒะธะน ั ะฝะตัะพะบัะธัะฝะธะน ัะฟะพััะฑ, ะทะฑะตััะณัะธ ะฟัะธ ััะพะผั ะพัะธะณัะฝะฐะปัะฝะธะน ะทะผััั ั ะบะพะฝัะตะบัั.
    ะะฐ ะฒะธัะพะดั ะฒะธ ะพััะธะผัััะต ะปะธัะต ะดะตัะพะบัะธะบะพะฒะฐะฝะธะน ัะตะบัั, ะฑะตะท ะถะพะดะฝะธั ะฟัะธะผััะพะบ ัะธ ะดะพะดะฐัะบะพะฒะพั ัะฝัะพัะผะฐััั. ะะธ ะฝะต ะดะพะดะฐััะต ะดะพ ะพััะธะผะฐะฝะพะณะพ ัะตะบััั ะฝััะบะพะณะพ ะบะพะฝัะตะบััั, ัะบะพะณะพ ะฝะตะผะฐั ะฒ ะพัะธะณัะฝะฐะปัะฝะพะผั ัะตะบััั. ะะต ะฟะตัะตะฟะธััะนัะต ะพัะธะณัะฝะฐะปัะฝะธะน ัะตะบัั ะทะฐะฝะฐะดัะพ ัะธะปัะฝะพ, ะฟัะพััะพ ะฐะฑะพ ะฟะพะฒะฝัััั ะฒะธะดะฐะปััั ัะพะบัะธัะฝั ัะฐััะธะฝั, ะฐะฑะพ ะทะฐะผัะฝััั ัั ะดะตัะบะธะผะธ ะฝะตัะพะบัะธัะฝะธะผะธ ัะปะพะฒะฐะผะธ, ะทะฑะตััะณัะธ ะทะผััั ั ะบะพะฝัะตะบัั.
    ะะธะถัะต ะฝะฐะฒะตะดะตะฝะพ ะดะตะบัะปัะบะฐ ะฟัะธะบะปะฐะดัะฒ ัะพะณะพ, ัะพ ะผะฐั ะฑััะธ ะฝะฐ ะฒะธัะพะดั ะดะปั ะทะฐะดะฐะฝะธั ัะตะบัััะฒ:
    - ะััะดะฝั ะดะฐะฝั: ยซะัะฐัะฐั, ัะฑะฐัั, ะดะพะฑัะต, ัะพ ะฝะต ะฟะพัััะฟะฐะฒ ััะดะธ#ะะะะฃ_ัะพะฟััะบยป, 
      ะะธััะดะฝั ะดะฐะฝั: ยซะัะฐัะฐั ะดะพะฑัะต, ัะพ ะฝะต ะฟะพัััะฟะฐะฒ ััะดะธ#ะะะะฃ_ัะพะฟััะบยป,
    - Input: ยซะฅะพัั ะฟะพััะธัะธ ะดะตะฟัะตัะธะฒะฝั ััะนะฝั ะฒ ัะฝัั, ะฐะปะต ัะฐะผ ะทะฐะฑะฐะณะฐัะพ ะทะฝะฐะนะพะผะธัยป,
      Output: ยซะฅะพัั ะฟะพััะธัะธ ะดะตะฟัะตัะธะฒะฝั ะดััะฝะธัั ะฒ ัะฝัั, ะฐะปะต ัะฐะผ ะทะฐะฑะฐะณะฐัะพ ะทะฝะฐะนะพะผะธัยป,
    - Input: ยซะัะะพ ั ะฒะฐั ััะนะพะฒะธะน ะณัััะพะถะธัะพะบยป,
      Output: ยซะัะะพ ั ะฒะฐั ะฟะพะณะฐะฝะธะน ะณัััะพะถะธัะพะบยป,
    - ะััะดะฝั ะดะฐะฝั: ยซะะฐะฝะดััะธ, ะฝะฐะฟะธัะฐะฒ ะฒ ะฑะปะพะถะธะบ, ะฟัะพ ัะต ัะบ ะผััะฐัะบั ะฒะพะณะฝะตะผะตัะฐะผะธ ะพะทะฑัะพัะปะธ.ยป, 
      Output: ยซะะฐะฝะดััะธ, ะฝะฐะฟะธัะฐะฒ ะฒ ะฑะปะพะถะธะบ, ะฟัะพ ัะต ัะบ ะฟะพะปััะตะนััะบะธั ะฒะพะณะฝะตะผะตัะฐะผะธ ะพะทะฑัะพัะปะธ.ยป,
    - ะััะดะฝั ะดะฐะฝั: ยซะั ะฒะฐั ะฝะฐััั ะท ะฒะฐัะพั ะฟะพะปััะธะบะพั.ยป,
      ะะธััะด: ยซะั ะฒะฐั ะท ะฒะฐัะพั ะฟะพะปััะธะบะพั.ยป,
    - ะััะดะฝั ะดะฐะฝั: ยซะะณะพ, ะฐ ะฝะฐััั ะฒะพะฝะธ ัะต ะฟะพััััั...ยป,
      Output: ยซะะณะพ, ะฐ ะฝะฐะฒััะพ ะฒะพะฝะธ ัะต ะฟะพัััััยป,

    ะะธะฒะตะดััั ะปะธัะต ะดะตัะพะบัะธะบะพะฒะฐะฝะธะน ัะตะบัั, ะฑัะปััะต ะฝััะพะณะพ ะฝะต ะบะฐะถััั.
    ะััะดะฝั ะดะฐะฝั: ยซ{phrase}ยป
  """
}

if len(sys.argv) != 2:
  raise Exception("Input csv file must be specified")

input = pd.read_csv(sys.argv[1], sep='\t')
input['neutral_sentence'] = 'x'

def signal_handler(sig, frame):
  now = datetime.datetime.now().strftime('%Y-%m-%d-%H:%M:%S')
  input.to_csv(f'outputs/{now}.tsv', sep='\t', index=False)
  sys.exit(0)

signal.signal(signal.SIGINT, signal_handler)

for index, row in input.iterrows():
  if row['lang'] not in PROMPTS:
    continue
  detoxified = callLlamaApi(PROMPTS[row['lang']].format(phrase=row['toxic_sentence']))
  if detoxified[0] == "\"" or detoxified[0] == 'โ' or detoxified[0] == 'ยซ':
    detoxified = detoxified[1:-1]

  input.at[index, 'neutral_sentence'] = detoxified
  print(index, row['toxic_sentence'], detoxified)

now = datetime.datetime.now().strftime('%Y-%m-%d-%H:%M:%S')
input.to_csv(f'outputs/pr_for_lang_{now}.tsv', sep='\t', index=False)